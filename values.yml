mdcore:
  fullnameOverride: metadefender
  storage_provisioner: custom
  storage_name: md-core-store-data-pvc
  env:
    LICENSING_CLEANUP: true
  core_components:
     postgres-core:
       name: postgres-core
       image: postgres:14.8
       env:
         - name: POSTGRES_PASSWORD
           valueFrom:
             secretKeyRef:
               name: metadefender
               key: db_password
         - name: POSTGRES_USER
           valueFrom:
             secretKeyRef:
               name: metadefender
               key: db_user
     md-core:
       replicas: 1
       env:
         - name: MD_USER
           valueFrom:
             secretKeyRef:
               name: metadefender
               key: mdcore_user
         - name: MD_PWD
           valueFrom:
            secretKeyRef:
              name: metadefender
              key: mdcore_password
         - name: MD_INSTANCE_NAME
           valueFrom:
             fieldRef:
               fieldPath: metadata.name
         - name: MY_POD_NAME
           valueFrom:
             fieldRef:
               fieldPath: metadata.name
         - name: MY_POD_NAMESPACE
           valueFrom:
             fieldRef:
               fieldPath: metadata.namespace
         - name: APIKEY
           valueFrom:
             secretKeyRef:
               name: metadefender
               key: api_key
         - name: LICENSE_KEY
           valueFrom:
             secretKeyRef:
               name: metadefender
               key: mdcore_license_key
         - name: DB_USER
           valueFrom:
             secretKeyRef:
               name: metadefender
               key: db_user
         - name: DB_PWD
           valueFrom:
             secretKeyRef:
               name: metadefender
               key: db_password
       tls:
         enabled: false
       service_type: LoadBalancer
       resources:
         requests:
           memory: "512Mi"
           cpu: "250m"
           ephemeral-storage: "5Gi"      
         limits:
           memory: "1Gi"
           cpu: "500m"
           ephemeral-storage: "10Gi"
  
  secrets:
    enabled: true
    createSecretStore: true
    useClusterSecretStore: true
    refreshInterval: 1h
    vault:
      address: http://vault.vault.svc:8200
      path: kv
      version: v2
      authMountPath: kubernetes
      role: eso-role
      serviceAccount: my-external-secrets
      serviceAccountNamespace: eso
    items:
      - k8sKey: mdcore_user
        remoteKey: mdcore
        property: mdcore_user
      - k8sKey: mdcore_password
        remoteKey: mdcore
        property: mdcore_password
      - k8sKey: db_user
        remoteKey: mdcore
        property: db_user
      - k8sKey: db_password
        remoteKey: mdcore
        property: db_password
      - k8sKey: api_key
        remoteKey: mdcore
        property: api_key
      - k8sKey: mdcore_license_key
        remoteKey: mdcore
        property: mdcore_license_key